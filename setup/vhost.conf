<VirtualHost *:80>
#	CustomLog /var/log/apache2/greysledge.rob-alogs combined
#	ErrorLog /var/log/apache2/greysledge.rob-elogs

	#SSLEngine on
	#SSLCertificateFile /etc/apache2/ssl/ssl.crt/sledge.crt
	#SSLCertificateKeyFile /etc/apache2/ssl/ssl.key/sledge.key

	DocumentRoot "{docroot}"
	ServerName "{hostname}"
	DirectoryIndex index.php

	# caching
	CacheDisable /
	ExpiresActive On
	ExpiresDefault A0
	<IfModule mod_headers.c>
		Header Set Cache-Control "max-age=0, no-store, no-cache"
	</IfModule>

	BrowserMatch Safari nokeepalive

        RewriteEngine On

        RewriteCond %{QUERY_STRING} !rss=
        RewriteRule ^\.rss$ /index.php?rss=1 [PT,L]
        RewriteRule ^(.*?)/\.rss /index.php/$1?rss=1 [PT,L]

        RewriteCond %{REQUEST_URI} !(^/assets|^/cache|^/sledge|^/_tokens)
        RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
        RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)/$ $1 [L,R]

        RewriteCond %{REQUEST_URI} !(^/assets|^/cache|^/sledge|^/_tokens)
        RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
        RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
        RewriteRule ^(.*)$ /index.php/$1 [PT,L]

        #AliasMatch ^/assets(.*)          /srv/projects/nhhg.assets/nhhg.dev$1
        #AliasMatch ^/cache(.*)           /srv/projects/nhhg.cache/nhhg.dev/$1
        AliasMatch ^/sledge/(.*)$                               {docroot}/modules/sledge/static/site/$1
        #AliasMatch ^/_tokens/([a-z]+)/([a-f0-9]{40})$           /srv/projects/nhhg.cache/nhhg.rob/tokens/$1/$2

#	ErrorDocument 404 /index.php/error/404

</VirtualHost>

# staging http vhost - just bounce to https
#<VirtualHost *:80>
#	CustomLog /var/log/apache2/greysledge.rob-alog combined
#	ErrorLog /var/log/apache2/greysledge.rob-elog
#	ServerName dev-greysledge.sledge.thisishoop.com
#	RewriteEngine On
#	RewriteRule ^(.*)$ https://dev-greysledge.sledge.thisishoop.com
#</VirtualHost>
