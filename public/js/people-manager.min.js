/*! boom-core - v0.0.0 (2016-05-15) */

!function(a,b,c){"use strict";c.PeopleManager=b.View.extend({el:a("body"),events:{"submit #b-groups-new":"createGroup","click #b-people-create":"createPerson","click #b-people-all":"showAllPeople"},initialize:function(a){this.$groupList=this.$("#b-groups-list"),this.$peopleTable=this.$("#b-people-table"),this.$content=this.$("#b-people-content"),this.groups=new c.Collections.Groups(a.groups),this.people=new c.Collections.People(a.people),this.router=new c.PeopleManager.Router({groups:this.groups,people:this.people}),this.listenTo(this.groups,"edit created",this.editGroup),this.listenTo(this.groups,"add",this.addGroup),this.listenTo(this.groups,"change created",this.sortGroups),this.listenTo(this.groups,"all sort",this.renderGroups),this.listenTo(this.people,"all sort filter",this.renderPeople),this.listenTo(this.people,"edit created",this.editPerson),this.listenTo(this.people,"created",this.showAllPeople),this.showAllPeople(),this.people.sort(),this.groups.sort(),b.history.start()},addGroup:function(a){var b=new c.PeopleManager.GroupListItem({model:a});this.$groupList.append(b.render().el)},addPersonToTable:function(a){var b=new c.PeopleManager.PeopleTableItem({model:a});this.$peopleTable.find("tbody").append(b.render().el)},createGroup:function(b){b.preventDefault();var c=a(b.target).find("input[type=text]"),d=this.groups.create({id:null,name:c.val()});this.groups.trigger("created",d),c.val("")},createPerson:function(a){a.preventDefault();var b=new c.PeopleManager.CreatePerson({groups:this.groups.models,people:this.people});this.show(b)},editPerson:function(a){var b=new c.PeopleManager.PersonView({model:a,groups:this.groups.models});this.show(b)},editGroup:function(a){var b=new c.PeopleManager.GroupView({model:a});this.show(b),b.$el.groupPermissionsEditor({group:a})},renderGroups:function(){return this.$groupList.empty(),this.groups.each(this.addGroup,this),this},renderPeople:function(){return this.$peopleTable.find("tbody").empty(),this.people.each(this.addPersonToTable,this),this},show:function(a){this.$content.html(a.render().el)},showAllPeople:function(){return this.$content.html(this.$peopleTable),this},sortGroups:function(){this.groups.sort()}})}(jQuery,Backbone,BoomCMS),function(a,b,c){"use strict";c.PeopleManager.CreatePerson=b.View.extend({tagName:"div",template:_.template(a("#b-person-create-form").html()),initialize:function(a){this.groups=a.groups,this.people=a.people},events:{"click button":"createPerson"},createPerson:function(a){a.preventDefault();var b=this.people.create(this.$("form").serializeJSON());this.people.trigger("created",b)},render:function(){return this.$el.html(this.template({groups:this.groups})),this.$("select").chosen(),this}})}(jQuery,Backbone,BoomCMS),function(a,b,c){"use strict";c.PeopleManager.GroupListItem=b.View.extend({tagName:"li",template:_.template(a("#b-group-list-item").html()),events:{"click .delete":"deleteGroup","click .edit":"editGroup"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},deleteGroup:function(){var a=this.model,b=c.confirm("Please confirm","Are you sure you want to remove this group? <br /><br /> This will delete the group from the database and cannot be undone!");b.done(function(){a.destroy()})},editGroup:function(){this.model.trigger("edit",this.model)}})}(jQuery,Backbone,BoomCMS),function(a,b,c){"use strict";c.PeopleManager.GroupView=b.View.extend({tagName:"div",template:_.template(a("#b-group-edit").html()),events:{"click #b-people-group-save":"saveGroupName","click h2, h2 + a":"editName","blur h2":"save"},editName:function(a){a.preventDefault(),this.$name.removeClass(c.editableClass).focus()},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$name=this.$("h2").addClass(c.editableClass),this},save:function(a){a.preventDefault(),this.model.set("name",this.$name.text()),this.$name.addClass(c.editableClass),this.model.save()}})}(jQuery,Backbone,BoomCMS),function(a,b,c){"use strict";c.PeopleManager.PeopleTableItem=b.View.extend({tagName:"tr",template:_.template(a("#b-people-table-item").html()),events:{"click .delete":"deletePerson"},deletePerson:function(a){a.preventDefault();var b=this.model;c.confirm("Please confirm","Are you sure you want to delete "+b.getName()+"?").done(function(){b.destroy()})},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())).find("time").timeago(),this}})}(jQuery,Backbone,BoomCMS),function(a,b,c){"use strict";c.PeopleManager.PersonView=b.View.extend({tagName:"div",template:_.template(a("#b-person-view").html()),events:{"click .name, .name + a":"editName","blur h2":"saveName"},initialize:function(a){this.groups=a.groups},render:function(){return this.$el.html(this.template({person:this.model,groups:this.groups})),this.$name=this.$(".name").addClass(c.editableClass),this.$("select[multiple]").chosen(),this},editName:function(a){a.preventDefault(),this.$name.removeClass(c.editableClass).focus()},saveName:function(a){a.preventDefault(),this.model.set("name",this.$name.text()),this.$name.addClass(c.editableClass),this.model.save()}})}(jQuery,Backbone,BoomCMS),function(a,b,c){"use strict";c.PeopleManager.Router=b.Router.extend({routes:{"group/:group/edit":"editGroup","group/:group":"viewGroup","person/:person":"editPerson"},initialize:function(a){this.groups=a.groups,this.people=a.people},editGroup:function(a){var b=this.groups.get(a);b.trigger("edit",b)},viewGroup:function(a){var b=this.groups.get(a);b.trigger("view",b)},editPerson:function(a){var b=this.people.get(a);b.trigger("edit",b)}})}(jQuery,Backbone,BoomCMS);
//# sourceMappingURL=people-manager.min.js.map